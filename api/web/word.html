<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>演示Demo</title>
</head>
<body>
    <script>
        var socket = new WebSocket('ws://localhost:29580');
        socket.onmessage = (e) => {
            alert(e.data);
        }
        function preview(){
            socket.send(JSON.stringify({
                "channel": "OFFICE_OPEN_WORD_PREVIEW",
                "params": {
                    "target": "http://localhost:8000/1.docx"
                }
            }))
        }

        function print(){
            socket.send(JSON.stringify({
                "channel": "OFFICE_OPEN_WORD_PRINT",
                "params": {
                    "target": "http://localhost:8000/1.docx"
                }
            }))
        }

        function editor() {
            socket.send(JSON.stringify({
                "id": "00000001",
                "channel": "OFFICE_OPEN_WORD_EDITOR",
                "params": {
                    "filename": "1.docx",
                    "target": "http://localhost:8000/1.docx",
                    "saveUrl": "http://localhost:8000/saveUrl",
                }
            }))
        }

        function previewExcel(){
            socket.send(JSON.stringify({
                "channel": "OFFICE_OPEN_EXCEL_PREVIEW",
                "params": {
                    "target": "C:/Users/zhang/Desktop/1.xlsx"
                }
            }))
        }

        function editorExcel(){
            socket.send(JSON.stringify({
                "channel": "OFFICE_OPEN_EXCEL_EDITOR",
                "params": {
                    "filename": "test.xlsx",
                    "target": "http://localhost:8000/test.xlsx",
                    "saveUrl":  "http://localhost:8000/saveUrl",
                }
            }))
        }

    </script>
    <button onclick="preview()">预览Word</button>
    <button onclick="print()">打印Word</button>
    <button onclick="editor()">编辑Word</button>
    <button onclick="editorExcel()">编辑EXCEL</button>
    <button onclick="previewExcel()">预览EXCEL</button>

</body>
</html>